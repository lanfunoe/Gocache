# Gocache 设计决策与常见问题

本文档记录了 Gocache 项目在设计过程中的关键决策点和常见问题解答。

---

## 1. 歌词存储方案选择

### 问题
歌词文件应该直接存在数据库中，还是放在文件系统或对象存储服务中？

### 方案对比

| 方案 | 优点 | 缺点 | 适用场景 |
|------|------|------|----------|
| **数据库存储** | 事务支持、查询灵活、备份简单、与元数据统一管理 | 大量数据时性能下降、数据库体积膨胀 | 歌词数量适中（<100万条）、需要全文搜索 |
| **文件系统存储** | 读写性能高、实现简单、易于CDN分发 | 备份复杂、跨服务器同步困难、文件碎片化 | 单机部署、歌词量大 |
| **对象存储服务** | 无限扩展、高可用、CDN集成、成本低 | 网络延迟、需要额外服务依赖 | 分布式部署、海量数据 |



## 2. 离线模式支持

### 问题
是否需要支持离线模式（无网络时仍可访问已缓存的数据）？

### 方案对比

| 方案 | 优点 | 实现要求 | 复杂度 |
|------|------|----------|--------|
| ✅ **支持离线模式** | 🎯 用户体验好，无网络时仍可使用<br>📉 减少对上游 API 的依赖<br>📱 适合移动端或网络不稳定环境 | 💾 存储完整数据（歌曲信息、歌手详情、专辑封面等）<br>🔄 设计数据同步机制<br>⚠️ 处理数据冲突和版本管理<br>🔍 查询优先使用本地数据<br>📊 实现增量同步 | 🔴 高 |
| ❌ **不支持离线模式**<br>（仅作为缓存层） | ⚡ 实现简单，维护成本低<br>🚫 不需要复杂的同步逻辑<br>🆕 数据始终保持最新 | 💾 本地数据库仅作为性能缓存<br>⏱️ 数据使用较短 TTL，过期后重新获取<br>🌐 缓存未命中时直接请求上游 API | 🟢 低 |


---